name: Prefect flow test
run-name: Prefect flow test
on: 
    # ä»¥ä¸‹ã®ãƒ–ãƒ©ãƒ³ãƒã«ãƒ—ãƒƒã‚·ãƒ¥ã•ã‚ŒãŸéš›èµ·å‹•
    # push:
    #     branches: ["github-actions-test"]
    # Githubã‚ˆã‚Šæ‰‹å‹•ã§èµ·å‹•
    workflow_dispatch:

env:
  # Docker ã‚¤ãƒ¡ãƒ¼ã‚¸ã® tar ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–å‡ºåŠ›å…ˆã®ãƒ‘ã‚¹
  PATH_CACHE: /tmp/docker-img-arch


  

jobs:
  Prefect_flow_test_init:
    runs-on: ubuntu-22.04
    environment:
      name: TEST
    steps:
      - run: echo "ğŸ‰ èµ·å‹•ã‚¤ãƒ™ãƒ³ãƒˆã®ç¨®é¡ (${{ github.event_name }})"
      - run: echo "ğŸ§ githubä¸Šã®OSã®ç¨®é¡ (${{ runner.os }})"
      - name: ãƒªãƒã‚¸ãƒˆãƒª(${{ github.repository }})ãƒ»ãƒ–ãƒ©ãƒ³ãƒ(${{ github.ref }})ã«ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆ
        # ä¸Šè¨˜ã®ãƒªãƒã‚¸ãƒˆãƒªãƒ»ãƒ–ãƒ©ãƒ³ãƒã«ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆ
        uses: actions/checkout@v4
      - name: ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ãƒã‚§ãƒƒã‚¯
        # ã‚¯ãƒ­ãƒ¼ãƒ³å¾Œã¯ã“ã“ã«ã‚½ãƒ¼ã‚¹ãŒæ ¼ç´ã•ã‚Œã‚‹ /home/runner/work/BrownieAtelier/BrownieAtelier
        run: |
          ls -a ${{ github.workspace }}


  call_mongo_container_up:
    runs-on: ubuntu-latest
    environment:
      name: TEST
    env:
      # 
      DOCKER_NETWORK: "--network sample-net"
      ## mongoDBç”¨ã‚³ãƒ³ãƒ†ãƒŠãƒ¼ã§å‚ç…§ã™ã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ã‚¿ã‚°
      MONGO_TAG: 7.0.1-jammy
      # Docker ã‚¤ãƒ¡ãƒ¼ã‚¸ã® tar ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–å‡ºåŠ›å…ˆã®ãƒ‘ã‚¹
      PATH_CACHE: /tmp/docker-img-arch

    steps:
      - name: Call reusable workflow
        uses: ./.github/workflows/mongo_container_up.yml
        with:
          docker-network: ${{ env.DOCKER_NETWORK }}
          path_cache: ${{ env.PATH_CACHE }}
          mongo_tag: ${{ env.MONGO_TAG }}
